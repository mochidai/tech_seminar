# Fingerprinting

# なぜ顧客を追跡するのか
* 個人の趣向は異なる。
* Webサイトの訪問者を追跡することで効果的な広告を打つことが出来る
  * 追跡とは？
    * Webサイトの訪問者はそのサーバのCookieと広告等のThird Party Cookieを記録することになる。
    * Googleは、利用者が別のデバイスでGoogleアカウントにログインすれば、利用者の広告クリックや購買履歴等の情報を追跡できる。

# ターゲティング広告
## ターゲティング広告とは
## 問題

#
Online Tracking: A 1-million-site Measurement and Analysis
Webサイトの種類毎に、追跡を目的とした仕組みを調べている

# Classic Tracking

# Web 0.0
HTMLファイルをやりとりするだけ
## 問題
認証機能なんてない
毎回ログインしなければいけない
HTTP auth はいろいろ大変

#
Cookies + third party

# Ever-Cookies
* ブラウザの中にはCookieを使った追跡を拒否する機能を入れ始めた
* 追跡をしようとする組織との戦い
CookieからID情報を抜いて、別の場所にID情報を入れる
* ID情報を保存する場所
  * ローカル環境、セッション管理
  * HSTS
  * キャッシュ（etags, Cache API, etc.)
  * プラグイン
  * その他たくさん

* HSTS による識別子付与
https://www.techscore.com/blog/2017/11/06/super-cookie/
HSTS 機能ではドメイン毎にプロトコル（HTTPS を利用するか否か）を不揮発領域に記録しますが、それを利用した Super Cookie は以下のような動作原理となっています。
ブラウザに付与する識別子（ここでは 256 ビット乱数）を生成する = NN
以下のような 256 個のドメインに https: でアクセスする
https://00.tracking.com/NN
https://01.tracking.com/NN
...
https://FE.tracking.com/NN
https://FF.tracking.com/NN
各 XX.tracking.com の処理時 NN の XX ビット目をチェックして
0 の場合は "Strict-Transport-Security: max-age=expireTime" を応答
1 の場合は "Strict-Transport-Security: max-age=0" を応答
結果として識別子 NN が利用プロトコル情報としてブラウザに記録される
識別子の復元時は以下のような 256 個のドメインに http: でアクセスする
http://00.tracking.com/
http://01.tracking.com/
...
http://FE.tracking.com/
http://FF.tracking.com/
HTTPS へのリダイレクトの有無から各ビットを復元し、最終的に 256 ビットの値 NN を復元

# Fingerprinting / Passive
## Classic Trackign
WebサイトはクライアントにIDを保存

## Fingerprinting, how
ほかの特定要素はたくさんある

# Suceeding at Fingerprinting

# Breath
- ユーザーエージェント

# User Agent String
- user-agent の歴史
- Katamari-Damacy of identifiers
- Brave / Chrome

# フォント
- フォントの種類
  - システム
  - ローカル
  - Web
- ローカルは様々な情報を持っている
  - Office
  - Photoshop
  - Goofery
- 絞り込みが簡単
  - プラグイン
  - CSS + span + width

# Canvas / WebGL
- HTML5のグラフィックタグ
  - canvas 矩形領域内でJavaScriptで操作可能
  - WebGL ウェブブラウザで3次元コンピュータグラフィックスを表示させる
- Pixel Perfect: Fingerprinting Canvas in HTML
  - Keaton Mowery and Hovav Shacham
- 描画API
  - 罫線を引く、図形
- 標準冠されているが、明確に違う
- 絞り込みが簡単
  - Create canvas
  - お絵かきする
  - toDataURL()

# ハードウェアの特定
- 多くのWeb APIはコンピュータの能力を漏らしている
  - CPUコアの数（HTML）
  - オーディオチャネルの数（Web Audio API)
  - num shaders 等 (WebGL API)
  - メモリ (Device Memory API)
  - ネットワーク (WebRTC, Network status)
- Semi identifying
- Easy to Extract
  - ブラウザは上記のいくつかの情報を持っている
  - ほとんどのプラットフォームは許可する仕組みをもっていない

# Fingerprinting Depth
https://panopticlick.eff.org/

# Fingerprinting in practice
- データベース
- 各エンドポイントにハッシュ
- 各値をハッシュして識別子にする

# Exercise

− fingerprint2.js
- できるだけ多くのfingerprinting手法を挙げよ
- どうやって実行しているか確認する
- どれが個人を特定するのに最も有効か予想せよ

https://fingerprintjs.github.io/fingerprintjs/

# アクセス制限
- 許可を求めるプロンプト
- ユーザジェスチャー
- first party or third party
- サイトエンゲージメント
  - Google が導入している

# ノイズを混入させる
- ステガノグラフィ
- 要素の細部に違い（識別子）を埋め込む
  - 画像、音声など方法は様々

# Privacy Budget
- 識別可能性を高めること

# 再度Fingerprinting2
- 対抗するfingerprinting 手法を選ぶ
  - 対策を提示する
- 対抗が難しいfingerprinting を選ぶ
  - なぜ対策するのが難しいか述べよ
